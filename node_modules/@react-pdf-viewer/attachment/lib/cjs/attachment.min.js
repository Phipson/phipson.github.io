"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@react-pdf-viewer/core");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=n(e),c=function(n){var c=n.files,r=e.useContext(t.LocalizationContext);return 0===c.length?a.default.createElement("div",{className:"rpv-attachment-list-empty"},r&&r.attachment?r.attachment.noAttachment:"There is no attachment"):a.default.createElement("ul",{className:"rpv-attachment-list"},c.map((function(e){return a.default.createElement("li",{className:"rpv-attachment-item",key:"attachment-"+e.fileName,title:r&&r.attachment?r.attachment.clickToDownload:"Click to download",onClick:function(){return t=e.fileName,n=e.data,a="string"==typeof n?"":URL.createObjectURL(new Blob([n],{type:""})),(c=document.createElement("a")).style.display="none",c.href=a||t,c.setAttribute("download",function(e){var t=e.split("/").pop();return t?t.split("#")[0].split("?")[0]:e}(t)),document.body.appendChild(c),c.click(),document.body.removeChild(c),void(a&&URL.revokeObjectURL(a));var t,n,a,c}},e.fileName)})))},r=function(n){var r=n.doc,o=e.useState({files:[],isLoaded:!1}),l=o[0],i=o[1];return e.useEffect((function(){r.getAttachments().then((function(e){var t=e?Object.keys(e).map((function(t){return{data:e[t].content,fileName:e[t].filename}})):[];i({files:t,isLoaded:!0})}))}),[r]),l.isLoaded?a.default.createElement(c,{files:l.files}):a.default.createElement(t.Spinner,null)},o=function(n){var c=n.store,o=e.useState(c.get("doc")),l=o[0],i=o[1],u=function(e){i(e)};return e.useEffect((function(){return c.subscribe("doc",u),function(){c.unsubscribe("doc",u)}}),[]),l?a.default.createElement(r,{doc:l}):a.default.createElement("div",{className:"rpv-attachment-list-loader"},a.default.createElement(t.Spinner,null))};exports.attachmentPlugin=function(){var e=t.createStore({});return{onDocumentLoad:function(t){e.update("doc",t.doc)},Attachments:function(){return a.default.createElement(o,{store:e})}}};

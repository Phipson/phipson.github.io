{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar React = require('react');\n\nvar core = require('@react-pdf-viewer/core');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar NextIcon = function () {\n  return React__default['default'].createElement(core.Icon, {\n    size: 16\n  }, React__default['default'].createElement(\"path\", {\n    d: \"M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043\\n                L23.541,5.627\"\n  }));\n};\n\nvar PreviousIcon = function () {\n  return React__default['default'].createElement(core.Icon, {\n    size: 16\n  }, React__default['default'].createElement(\"path\", {\n    d: \"M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8\\n                L0.535,18.373\"\n  }));\n};\n\nvar SearchIcon = function () {\n  return React__default['default'].createElement(core.Icon, {\n    size: 16\n  }, React__default['default'].createElement(\"path\", {\n    d: \"M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z\\n                M23.5,23.5\\n                l-5.929-5.929\"\n  }));\n};\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar EMPTY_KEYWORD_REGEXP = new RegExp(' ');\n\nvar useDocument = function (store) {\n  var _a = React.useState(store.get('doc')),\n      currentDoc = _a[0],\n      setCurrentDoc = _a[1];\n\n  var handleDocumentChanged = function (doc) {\n    setCurrentDoc(doc);\n  };\n\n  React.useEffect(function () {\n    store.subscribe('doc', handleDocumentChanged);\n    return function () {\n      store.unsubscribe('doc', handleDocumentChanged);\n    };\n  }, []);\n  return {\n    currentDoc: currentDoc\n  };\n};\n\nvar useSearch = function (doc, store) {\n  var _a = React.useState(''),\n      keyword = _a[0],\n      setKeyword = _a[1];\n\n  var _b = React.useState([]),\n      found = _b[0],\n      setFound = _b[1];\n\n  var _c = React.useState(0),\n      currentMatch = _c[0],\n      setCurrentMatch = _c[1];\n\n  var _d = React.useState(false),\n      matchCase = _d[0],\n      setMatchCase = _d[1];\n\n  var textContents = React.useRef([]);\n\n  var _e = React.useState(false),\n      wholeWords = _e[0],\n      setWholeWords = _e[1];\n\n  var indexArr = Array(doc.numPages).fill(0).map(function (_, i) {\n    return i;\n  });\n\n  var changeMatchCase = function (isChecked) {\n    setMatchCase(isChecked);\n\n    if (keyword) {\n      searchFor(keyword, isChecked, wholeWords);\n    }\n  };\n\n  var changeWholeWords = function (isChecked) {\n    setWholeWords(isChecked);\n\n    if (keyword) {\n      searchFor(keyword, matchCase, isChecked);\n    }\n  };\n\n  var jumpToPreviousMatch = function () {\n    if (!keyword) {\n      return;\n    }\n\n    var prev = currentMatch - 1;\n    var updated = prev > 0 ? prev : found.length;\n    setCurrentMatch(updated);\n    jumpToMatch(found[updated - 1]);\n  };\n\n  var jumpToNextMatch = function () {\n    if (!keyword) {\n      return;\n    }\n\n    var next = currentMatch + 1;\n    var updated = next <= found.length ? next : 1;\n    setCurrentMatch(updated);\n    jumpToMatch(found[updated - 1]);\n  };\n\n  var clearKeyword = function () {\n    if (!keyword) {\n      return;\n    }\n\n    store.update('keyword', [EMPTY_KEYWORD_REGEXP]);\n    setKeyword('');\n    setCurrentMatch(0);\n    setFound([]);\n    setMatchCase(false);\n    setWholeWords(false);\n  };\n\n  var search = function () {\n    return searchFor(keyword, matchCase, wholeWords);\n  };\n\n  var buildKeywordRegex = function (keywordParam, matchCaseParam, wholeWordsParam) {\n    var source = wholeWordsParam ? \" \" + keywordParam + \" \" : keywordParam;\n    var flags = matchCaseParam ? 'g' : 'gi';\n    return new RegExp(source, flags);\n  };\n\n  var getTextContents = function () {\n    var promises = indexArr.map(function (pageIndex) {\n      return doc.getPage(pageIndex + 1).then(function (page) {\n        return page.getTextContent();\n      }).then(function (content) {\n        var pageContent = content.items.map(function (item) {\n          return item.str || '';\n        }).join('');\n        return Promise.resolve({\n          pageContent: pageContent,\n          pageIndex: pageIndex\n        });\n      });\n    });\n    return Promise.all(promises).then(function (data) {\n      data.sort(function (a, b) {\n        return a.pageIndex - b.pageIndex;\n      });\n      return Promise.resolve(data.map(function (item) {\n        return item.pageContent;\n      }));\n    });\n  };\n\n  var jumpToMatch = function (match) {\n    var jumpToPage = store.get('jumpToPage');\n\n    if (jumpToPage) {\n      jumpToPage(match.pageIndex);\n    }\n\n    store.update('match', match);\n  };\n\n  var searchFor = function (keywordParam, matchCaseParam, wholeWordsParam) {\n    var regexp = buildKeywordRegex(keywordParam, matchCaseParam, wholeWordsParam);\n    store.update('keyword', [regexp]);\n    setCurrentMatch(0);\n    setFound([]);\n    var promise = textContents.current.length === 0 ? getTextContents().then(function (response) {\n      textContents.current = response;\n      return Promise.resolve(response);\n    }) : Promise.resolve(textContents.current);\n    promise.then(function (response) {\n      var arr = [];\n      response.forEach(function (item, pageIndex) {\n        var numMatches = (item.match(regexp) || []).length;\n\n        for (var matchIndex = 0; matchIndex < numMatches; matchIndex++) {\n          arr.push({\n            matchIndex: matchIndex,\n            pageIndex: pageIndex\n          });\n        }\n      });\n      setFound(arr);\n\n      if (arr.length > 0) {\n        setCurrentMatch(1);\n        jumpToMatch(arr[0]);\n      }\n    });\n  };\n\n  return {\n    clearKeyword: clearKeyword,\n    changeMatchCase: changeMatchCase,\n    changeWholeWords: changeWholeWords,\n    currentMatch: currentMatch,\n    jumpToNextMatch: jumpToNextMatch,\n    jumpToPreviousMatch: jumpToPreviousMatch,\n    keyword: keyword,\n    matchCase: matchCase,\n    numberOfMatches: found.length,\n    wholeWords: wholeWords,\n    search: search,\n    setKeyword: setKeyword\n  };\n};\n\nvar Inner = function (_a) {\n  var children = _a.children,\n      doc = _a.doc,\n      store = _a.store;\n  var result = useSearch(doc, store);\n  return children(__assign({}, result));\n};\n\nvar Search = function (_a) {\n  var children = _a.children,\n      store = _a.store;\n  var currentDoc = useDocument(store).currentDoc;\n  return currentDoc ? React__default['default'].createElement(Inner, {\n    doc: currentDoc,\n    store: store\n  }, children) : React__default['default'].createElement(React__default['default'].Fragment, null);\n};\n\nvar PORTAL_OFFSET = {\n  left: 0,\n  top: 8\n};\n\nvar SearchPopover = function (_a) {\n  var doc = _a.doc,\n      store = _a.store,\n      onToggle = _a.onToggle;\n  var l10n = React.useContext(core.LocalizationContext);\n\n  var _b = useSearch(doc, store),\n      clearKeyword = _b.clearKeyword,\n      changeMatchCase = _b.changeMatchCase,\n      changeWholeWords = _b.changeWholeWords,\n      currentMatch = _b.currentMatch,\n      jumpToNextMatch = _b.jumpToNextMatch,\n      jumpToPreviousMatch = _b.jumpToPreviousMatch,\n      keyword = _b.keyword,\n      matchCase = _b.matchCase,\n      numberOfMatches = _b.numberOfMatches,\n      wholeWords = _b.wholeWords,\n      search = _b.search,\n      setKeyword = _b.setKeyword;\n\n  var onChangeKeyword = function (e) {\n    setKeyword(e.target.value);\n  };\n\n  var onKeydownSearch = function (e) {\n    if (e.keyCode !== 13 || !keyword) {\n      return;\n    }\n\n    search();\n  };\n\n  var onChangeMatchCase = function (e) {\n    changeMatchCase(e.target.checked);\n  };\n\n  var onChangeWholeWords = function (e) {\n    changeWholeWords(e.target.checked);\n  };\n\n  var onClose = function () {\n    onToggle();\n    clearKeyword();\n  };\n\n  return React__default['default'].createElement(\"div\", {\n    className: 'rpv-search-popover'\n  }, React__default['default'].createElement(\"div\", {\n    className: 'rpv-search-popover-input-counter'\n  }, React__default['default'].createElement(\"input\", {\n    className: 'rpv-search-popover-input',\n    placeholder: l10n && l10n.search ? l10n.search.enterToSearch : 'Enter to search',\n    type: \"text\",\n    value: keyword,\n    onChange: onChangeKeyword,\n    onKeyDown: onKeydownSearch\n  }), React__default['default'].createElement(\"div\", {\n    className: 'rpv-search-popover-counter'\n  }, currentMatch, \"/\", numberOfMatches)), React__default['default'].createElement(\"label\", {\n    className: 'rpv-search-popover-label'\n  }, React__default['default'].createElement(\"input\", {\n    className: 'rpv-search-popover-label-checkbox',\n    checked: matchCase,\n    type: \"checkbox\",\n    onChange: onChangeMatchCase\n  }), \" \", l10n && l10n.search ? l10n.search.matchCase : 'Match case'), React__default['default'].createElement(\"label\", {\n    className: 'rpv-search-popover-label'\n  }, React__default['default'].createElement(\"input\", {\n    className: 'rpv-search-popover-label-checkbox',\n    checked: wholeWords,\n    type: \"checkbox\",\n    onChange: onChangeWholeWords\n  }), \" \", l10n && l10n.search ? l10n.search.wholeWords : 'Whole words'), React__default['default'].createElement(\"div\", {\n    className: 'rpv-search-popover-footer'\n  }, React__default['default'].createElement(\"div\", {\n    className: 'rpv-search-popover-footer-item'\n  }, React__default['default'].createElement(core.Tooltip, {\n    position: core.Position.BottomCenter,\n    target: React__default['default'].createElement(core.Button, {\n      onClick: jumpToPreviousMatch\n    }, React__default['default'].createElement(PreviousIcon, null)),\n    content: function () {\n      return l10n && l10n.search ? l10n.search.previousMatch : 'Previous match';\n    },\n    offset: PORTAL_OFFSET\n  })), React__default['default'].createElement(\"div\", {\n    className: 'rpv-search-popover-footer-item'\n  }, React__default['default'].createElement(core.Tooltip, {\n    position: core.Position.BottomCenter,\n    target: React__default['default'].createElement(core.Button, {\n      onClick: jumpToNextMatch\n    }, React__default['default'].createElement(NextIcon, null)),\n    content: function () {\n      return l10n && l10n.search ? l10n.search.nextMatch : 'Next match';\n    },\n    offset: PORTAL_OFFSET\n  })), React__default['default'].createElement(\"div\", {\n    className: 'rpv-search-popover-footer-button'\n  }, React__default['default'].createElement(core.PrimaryButton, {\n    onClick: onClose\n  }, l10n && l10n.search ? l10n.search.close : 'Close'))));\n};\n\nvar ShowSearchPopoverDecorator = function (_a) {\n  var children = _a.children,\n      onClick = _a.onClick;\n  var l10n = React.useContext(core.LocalizationContext);\n  var label = l10n && l10n.search ? l10n.search.search : 'Search';\n  var icon = React__default['default'].createElement(SearchIcon, null);\n  return children({\n    icon: icon,\n    label: label,\n    onClick: onClick\n  });\n};\n\nvar TOOLTIP_OFFSET = {\n  left: 0,\n  top: 8\n};\n\nvar ShowSearchPopoverButton = function (_a) {\n  var onClick = _a.onClick;\n  return React__default['default'].createElement(ShowSearchPopoverDecorator, {\n    onClick: onClick\n  }, function (p) {\n    return React__default['default'].createElement(core.Tooltip, {\n      position: core.Position.BottomCenter,\n      target: React__default['default'].createElement(core.Button, {\n        onClick: onClick\n      }, p.icon),\n      content: function () {\n        return p.label;\n      },\n      offset: TOOLTIP_OFFSET\n    });\n  });\n};\n\nvar PORTAL_OFFSET$1 = {\n  left: 0,\n  top: 8\n};\n\nvar ShowSearchPopover = function (_a) {\n  var children = _a.children,\n      store = _a.store;\n  var currentDoc = useDocument(store).currentDoc;\n\n  var defaultChildren = function (props) {\n    return React__default['default'].createElement(ShowSearchPopoverButton, __assign({}, props));\n  };\n\n  var render = children || defaultChildren;\n  return currentDoc ? React__default['default'].createElement(core.Popover, {\n    position: core.Position.BottomLeft,\n    target: function (toggle) {\n      return render({\n        onClick: toggle\n      });\n    },\n    content: function (toggle) {\n      return React__default['default'].createElement(SearchPopover, {\n        doc: currentDoc,\n        store: store,\n        onToggle: toggle\n      });\n    },\n    offset: PORTAL_OFFSET$1,\n    closeOnClickOutside: false,\n    closeOnEscape: true\n  }) : React__default['default'].createElement(React__default['default'].Fragment, null);\n};\n\nvar calculateOffset = function (children, parent) {\n  var top = children.offsetTop;\n  var left = children.offsetLeft;\n  var p = children.parentElement;\n\n  while (p && p !== parent) {\n    top += p.offsetTop;\n    left += p.offsetLeft;\n    p = p.parentElement;\n  }\n\n  return {\n    left: left,\n    top: top\n  };\n};\n\nvar removeNode = function (ele) {\n  var parent = ele.parentNode;\n\n  if (parent) {\n    parent.removeChild(ele);\n  }\n};\n\nvar replaceNode = function (replacementNode, node) {\n  removeNode(replacementNode);\n  var parent = node.parentNode;\n\n  if (parent) {\n    parent.insertBefore(replacementNode, node);\n  }\n\n  removeNode(node);\n};\n\nvar unwrap = function (ele) {\n  var parent = ele.parentNode;\n\n  if (!parent) {\n    return;\n  }\n\n  var range = document.createRange();\n  range.selectNodeContents(ele);\n  replaceNode(range.extractContents(), ele);\n  parent.normalize();\n};\n\nvar Tracker = function (_a) {\n  var pageIndex = _a.pageIndex,\n      store = _a.store;\n\n  var _b = React.useState({\n    matchIndex: -1,\n    pageIndex: -1\n  }),\n      match = _b[0],\n      setMatch = _b[1];\n\n  var _c = React.useState([EMPTY_KEYWORD_REGEXP]),\n      keywordRegexp = _c[0],\n      setKeywordRegexp = _c[1];\n\n  var _d = React.useState({\n    pageIndex: pageIndex,\n    scale: 1,\n    status: core.LayerRenderStatus.PreRender\n  }),\n      renderStatus = _d[0],\n      setRenderStatus = _d[1];\n\n  var currentMatchRef = React.useRef(null);\n\n  var unhighlightAll = function (containerEle) {\n    var highlightNodes = containerEle.querySelectorAll('span.rpv-search-text-highlight');\n    var total = highlightNodes.length;\n\n    for (var i = 0; i < total; i++) {\n      highlightNodes[i].parentElement.removeChild(highlightNodes[i]);\n    }\n  };\n\n  var highlight = function (keyword, containerEle, span) {\n    var text = span.textContent;\n\n    if (!keyword.source.trim() || !text) {\n      return;\n    }\n\n    var startOffset = text.search(keyword);\n    var firstChild = span.firstChild;\n\n    if (startOffset === -1 || !firstChild) {\n      return;\n    }\n\n    var endOffset = startOffset + keyword.source.length;\n    var range = document.createRange();\n    range.setStart(firstChild, startOffset);\n    range.setEnd(firstChild, endOffset);\n    var wrapper = document.createElement('span');\n    range.surroundContents(wrapper);\n    var wrapperRect = wrapper.getBoundingClientRect();\n    var containerRect = containerEle.getBoundingClientRect();\n    var highlightEle = document.createElement('span');\n    containerEle.appendChild(highlightEle);\n    highlightEle.style.left = 100 * (wrapperRect.left - containerRect.left) / containerRect.width + \"%\";\n    highlightEle.style.top = 100 * (wrapperRect.top - containerRect.top) / containerRect.height + \"%\";\n    highlightEle.style.width = 100 * wrapperRect.width / containerRect.width + \"%\";\n    highlightEle.style.height = 100 * wrapperRect.height / containerRect.height + \"%\";\n    highlightEle.classList.add('rpv-search-text-highlight');\n    unwrap(wrapper);\n  };\n\n  var highlightAll = function (containerEle) {\n    var spans = [].slice.call(containerEle.querySelectorAll('.rpv-core-text'));\n    keywordRegexp.forEach(function (keyword) {\n      spans.forEach(function (span) {\n        highlight(keyword, containerEle, span);\n      });\n    });\n  };\n\n  var handleKeywordChanged = function (keyword) {\n    if (keyword && keyword.length > 0) {\n      setKeywordRegexp(keyword);\n    }\n  };\n\n  var handleMatchChanged = function (currentMatch) {\n    setMatch(currentMatch);\n  };\n\n  var handleRenderStatusChanged = function (status) {\n    if (!status.has(pageIndex)) {\n      return;\n    }\n\n    var currentStatus = status.get(pageIndex);\n\n    if (currentStatus) {\n      setRenderStatus({\n        ele: currentStatus.ele,\n        pageIndex: pageIndex,\n        scale: currentStatus.scale,\n        status: currentStatus.status\n      });\n    }\n  };\n\n  var isEmptyKeyword = function () {\n    return keywordRegexp.length === 0 || keywordRegexp.length === 1 && keywordRegexp[0].source.trim() === '';\n  };\n\n  React.useEffect(function () {\n    if (isEmptyKeyword() || !renderStatus.ele || renderStatus.status !== core.LayerRenderStatus.DidRender) {\n      return;\n    }\n\n    var containerEle = renderStatus.ele;\n    unhighlightAll(containerEle);\n    highlightAll(containerEle);\n    scrollToMatch();\n  }, [keywordRegexp, match, renderStatus.status]);\n  React.useEffect(function () {\n    if (isEmptyKeyword() && renderStatus.ele && renderStatus.status === core.LayerRenderStatus.DidRender) {\n      unhighlightAll(renderStatus.ele);\n    }\n  }, [keywordRegexp, renderStatus.status]);\n\n  var scrollToMatch = function () {\n    if (match.pageIndex !== pageIndex || !renderStatus.ele || renderStatus.status !== core.LayerRenderStatus.DidRender) {\n      return;\n    }\n\n    var container = renderStatus.ele;\n    var spans = container.querySelectorAll('.rpv-search-text-highlight');\n\n    if (match.matchIndex < spans.length) {\n      var span = spans[match.matchIndex];\n\n      var _a = calculateOffset(span, container),\n          left = _a.left,\n          top_1 = _a.top;\n\n      var jump = store.get('jumpToDestination');\n\n      if (jump) {\n        jump(pageIndex, (container.getBoundingClientRect().height - top_1) / renderStatus.scale, left / renderStatus.scale, renderStatus.scale);\n\n        if (currentMatchRef.current) {\n          currentMatchRef.current.classList.remove('rpv-search-text-highlight-current');\n        }\n\n        currentMatchRef.current = span;\n        span.classList.add('rpv-search-text-highlight-current');\n      }\n    }\n  };\n\n  React.useEffect(function () {\n    store.subscribe('keyword', handleKeywordChanged);\n    store.subscribe('match', handleMatchChanged);\n    store.subscribe('renderStatus', handleRenderStatusChanged);\n    return function () {\n      store.unsubscribe('keyword', handleKeywordChanged);\n      store.unsubscribe('match', handleMatchChanged);\n      store.unsubscribe('renderStatus', handleRenderStatusChanged);\n    };\n  }, []);\n  return React__default['default'].createElement(React__default['default'].Fragment, null);\n};\n\nvar searchPlugin = function (props) {\n  var store = core.createStore({\n    renderStatus: new Map()\n  });\n\n  var SearchDecorator = function (props) {\n    return React__default['default'].createElement(Search, __assign({}, props, {\n      store: store\n    }));\n  };\n\n  var ShowSearchPopoverDecorator = function (props) {\n    return React__default['default'].createElement(ShowSearchPopover, __assign({}, props, {\n      store: store\n    }));\n  };\n\n  var ShowSearchPopoverButtonDecorator = function () {\n    return React__default['default'].createElement(ShowSearchPopoverDecorator, null, function (props) {\n      return React__default['default'].createElement(ShowSearchPopoverButton, __assign({}, props));\n    });\n  };\n\n  var renderViewer = function (props) {\n    var currentSlot = props.slot;\n\n    if (currentSlot.subSlot) {\n      currentSlot.subSlot.children = React__default['default'].createElement(React__default['default'].Fragment, null, Array(props.doc.numPages).fill(0).map(function (_, index) {\n        return React__default['default'].createElement(Tracker, {\n          key: index,\n          pageIndex: index,\n          store: store\n        });\n      }), currentSlot.subSlot.children);\n    }\n\n    return currentSlot;\n  };\n\n  var normalizeKeywordItem = function (keyword) {\n    return typeof keyword === 'string' ? keyword === '' ? EMPTY_KEYWORD_REGEXP : new RegExp(keyword) : keyword || EMPTY_KEYWORD_REGEXP;\n  };\n\n  return {\n    install: function (pluginFunctions) {\n      var keyword = [EMPTY_KEYWORD_REGEXP];\n\n      if (props) {\n        if (Array.isArray(props.keyword)) {\n          keyword = props.keyword.map(function (k) {\n            return normalizeKeywordItem(k);\n          });\n        } else {\n          keyword = [normalizeKeywordItem(props.keyword)];\n        }\n      }\n\n      store.update('jumpToDestination', pluginFunctions.jumpToDestination);\n      store.update('jumpToPage', pluginFunctions.jumpToPage);\n      store.update('keyword', keyword);\n    },\n    renderViewer: renderViewer,\n    uninstall: function (props) {\n      var renderStatus = store.get('renderStatus');\n\n      if (renderStatus) {\n        renderStatus.clear();\n      }\n    },\n    onDocumentLoad: function (props) {\n      store.update('doc', props.doc);\n    },\n    onTextLayerRender: function (props) {\n      var renderStatus = store.get('renderStatus');\n\n      if (renderStatus) {\n        renderStatus = renderStatus.set(props.pageIndex, props);\n        store.update('renderStatus', renderStatus);\n      }\n    },\n    Search: SearchDecorator,\n    ShowSearchPopover: ShowSearchPopoverDecorator,\n    ShowSearchPopoverButton: ShowSearchPopoverButtonDecorator\n  };\n};\n\nexports.NextIcon = NextIcon;\nexports.PreviousIcon = PreviousIcon;\nexports.SearchIcon = SearchIcon;\nexports.searchPlugin = searchPlugin;","map":{"version":3,"sources":["/Users/phipson/Documents/GitProjects/phipson.github.io/webv5/node_modules/@react-pdf-viewer/search/lib/cjs/search.js"],"names":["Object","defineProperty","exports","value","React","require","core","_interopDefaultLegacy","e","React__default","NextIcon","createElement","Icon","size","d","PreviousIcon","SearchIcon","__assign","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","EMPTY_KEYWORD_REGEXP","RegExp","useDocument","store","_a","useState","get","currentDoc","setCurrentDoc","handleDocumentChanged","doc","useEffect","subscribe","unsubscribe","useSearch","keyword","setKeyword","_b","found","setFound","_c","currentMatch","setCurrentMatch","_d","matchCase","setMatchCase","textContents","useRef","_e","wholeWords","setWholeWords","indexArr","Array","numPages","fill","map","_","changeMatchCase","isChecked","searchFor","changeWholeWords","jumpToPreviousMatch","prev","updated","jumpToMatch","jumpToNextMatch","next","clearKeyword","update","search","buildKeywordRegex","keywordParam","matchCaseParam","wholeWordsParam","source","flags","getTextContents","promises","pageIndex","getPage","then","page","getTextContent","content","pageContent","items","item","str","join","Promise","resolve","all","data","sort","a","b","match","jumpToPage","regexp","promise","current","response","arr","forEach","numMatches","matchIndex","push","numberOfMatches","Inner","children","result","Search","Fragment","PORTAL_OFFSET","left","top","SearchPopover","onToggle","l10n","useContext","LocalizationContext","onChangeKeyword","target","onKeydownSearch","keyCode","onChangeMatchCase","checked","onChangeWholeWords","onClose","className","placeholder","enterToSearch","type","onChange","onKeyDown","Tooltip","position","Position","BottomCenter","Button","onClick","previousMatch","offset","nextMatch","PrimaryButton","close","ShowSearchPopoverDecorator","label","icon","TOOLTIP_OFFSET","ShowSearchPopoverButton","PORTAL_OFFSET$1","ShowSearchPopover","defaultChildren","props","render","Popover","BottomLeft","toggle","closeOnClickOutside","closeOnEscape","calculateOffset","parent","offsetTop","offsetLeft","parentElement","removeNode","ele","parentNode","removeChild","replaceNode","replacementNode","node","insertBefore","unwrap","range","document","createRange","selectNodeContents","extractContents","normalize","Tracker","setMatch","keywordRegexp","setKeywordRegexp","scale","status","LayerRenderStatus","PreRender","renderStatus","setRenderStatus","currentMatchRef","unhighlightAll","containerEle","highlightNodes","querySelectorAll","total","highlight","span","text","textContent","trim","startOffset","firstChild","endOffset","setStart","setEnd","wrapper","surroundContents","wrapperRect","getBoundingClientRect","containerRect","highlightEle","appendChild","style","width","height","classList","add","highlightAll","spans","slice","handleKeywordChanged","handleMatchChanged","handleRenderStatusChanged","has","currentStatus","isEmptyKeyword","DidRender","scrollToMatch","container","top_1","jump","remove","searchPlugin","createStore","Map","SearchDecorator","ShowSearchPopoverButtonDecorator","renderViewer","currentSlot","slot","subSlot","index","key","normalizeKeywordItem","install","pluginFunctions","isArray","k","jumpToDestination","uninstall","clear","onDocumentLoad","onTextLayerRender","set"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar React = require('react');\nvar core = require('@react-pdf-viewer/core');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar NextIcon = function () {\n    return (React__default['default'].createElement(core.Icon, { size: 16 },\n        React__default['default'].createElement(\"path\", { d: \"M0.541,5.627L11.666,18.2c0.183,0.207,0.499,0.226,0.706,0.043c0.015-0.014,0.03-0.028,0.043-0.043\\n                L23.541,5.627\" })));\n};\n\nvar PreviousIcon = function () {\n    return (React__default['default'].createElement(core.Icon, { size: 16 },\n        React__default['default'].createElement(\"path\", { d: \"M23.535,18.373L12.409,5.8c-0.183-0.207-0.499-0.226-0.706-0.043C11.688,5.77,11.674,5.785,11.66,5.8\\n                L0.535,18.373\" })));\n};\n\nvar SearchIcon = function () {\n    return (React__default['default'].createElement(core.Icon, { size: 16 },\n        React__default['default'].createElement(\"path\", { d: \"M10.5,0.5c5.523,0,10,4.477,10,10s-4.477,10-10,10s-10-4.477-10-10S4.977,0.5,10.5,0.5z\\n                M23.5,23.5\\n                l-5.929-5.929\" })));\n};\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nvar EMPTY_KEYWORD_REGEXP = new RegExp(' ');\n\nvar useDocument = function (store) {\n    var _a = React.useState(store.get('doc')), currentDoc = _a[0], setCurrentDoc = _a[1];\n    var handleDocumentChanged = function (doc) {\n        setCurrentDoc(doc);\n    };\n    React.useEffect(function () {\n        store.subscribe('doc', handleDocumentChanged);\n        return function () {\n            store.unsubscribe('doc', handleDocumentChanged);\n        };\n    }, []);\n    return { currentDoc: currentDoc };\n};\n\nvar useSearch = function (doc, store) {\n    var _a = React.useState(''), keyword = _a[0], setKeyword = _a[1];\n    var _b = React.useState([]), found = _b[0], setFound = _b[1];\n    var _c = React.useState(0), currentMatch = _c[0], setCurrentMatch = _c[1];\n    var _d = React.useState(false), matchCase = _d[0], setMatchCase = _d[1];\n    var textContents = React.useRef([]);\n    var _e = React.useState(false), wholeWords = _e[0], setWholeWords = _e[1];\n    var indexArr = Array(doc.numPages)\n        .fill(0)\n        .map(function (_, i) { return i; });\n    var changeMatchCase = function (isChecked) {\n        setMatchCase(isChecked);\n        if (keyword) {\n            searchFor(keyword, isChecked, wholeWords);\n        }\n    };\n    var changeWholeWords = function (isChecked) {\n        setWholeWords(isChecked);\n        if (keyword) {\n            searchFor(keyword, matchCase, isChecked);\n        }\n    };\n    var jumpToPreviousMatch = function () {\n        if (!keyword) {\n            return;\n        }\n        var prev = currentMatch - 1;\n        var updated = prev > 0 ? prev : found.length;\n        setCurrentMatch(updated);\n        jumpToMatch(found[updated - 1]);\n    };\n    var jumpToNextMatch = function () {\n        if (!keyword) {\n            return;\n        }\n        var next = currentMatch + 1;\n        var updated = next <= found.length ? next : 1;\n        setCurrentMatch(updated);\n        jumpToMatch(found[updated - 1]);\n    };\n    var clearKeyword = function () {\n        if (!keyword) {\n            return;\n        }\n        store.update('keyword', [EMPTY_KEYWORD_REGEXP]);\n        setKeyword('');\n        setCurrentMatch(0);\n        setFound([]);\n        setMatchCase(false);\n        setWholeWords(false);\n    };\n    var search = function () { return searchFor(keyword, matchCase, wholeWords); };\n    var buildKeywordRegex = function (keywordParam, matchCaseParam, wholeWordsParam) {\n        var source = wholeWordsParam ? \" \" + keywordParam + \" \" : keywordParam;\n        var flags = matchCaseParam ? 'g' : 'gi';\n        return new RegExp(source, flags);\n    };\n    var getTextContents = function () {\n        var promises = indexArr.map(function (pageIndex) {\n            return doc\n                .getPage(pageIndex + 1)\n                .then(function (page) {\n                return page.getTextContent();\n            })\n                .then(function (content) {\n                var pageContent = content.items\n                    .map(function (item) { return item.str || ''; })\n                    .join('');\n                return Promise.resolve({\n                    pageContent: pageContent,\n                    pageIndex: pageIndex,\n                });\n            });\n        });\n        return Promise.all(promises).then(function (data) {\n            data.sort(function (a, b) { return a.pageIndex - b.pageIndex; });\n            return Promise.resolve(data.map(function (item) { return item.pageContent; }));\n        });\n    };\n    var jumpToMatch = function (match) {\n        var jumpToPage = store.get('jumpToPage');\n        if (jumpToPage) {\n            jumpToPage(match.pageIndex);\n        }\n        store.update('match', match);\n    };\n    var searchFor = function (keywordParam, matchCaseParam, wholeWordsParam) {\n        var regexp = buildKeywordRegex(keywordParam, matchCaseParam, wholeWordsParam);\n        store.update('keyword', [regexp]);\n        setCurrentMatch(0);\n        setFound([]);\n        var promise = textContents.current.length === 0\n            ? getTextContents().then(function (response) {\n                textContents.current = response;\n                return Promise.resolve(response);\n            })\n            : Promise.resolve(textContents.current);\n        promise.then(function (response) {\n            var arr = [];\n            response.forEach(function (item, pageIndex) {\n                var numMatches = (item.match(regexp) || []).length;\n                for (var matchIndex = 0; matchIndex < numMatches; matchIndex++) {\n                    arr.push({\n                        matchIndex: matchIndex,\n                        pageIndex: pageIndex,\n                    });\n                }\n            });\n            setFound(arr);\n            if (arr.length > 0) {\n                setCurrentMatch(1);\n                jumpToMatch(arr[0]);\n            }\n        });\n    };\n    return {\n        clearKeyword: clearKeyword,\n        changeMatchCase: changeMatchCase,\n        changeWholeWords: changeWholeWords,\n        currentMatch: currentMatch,\n        jumpToNextMatch: jumpToNextMatch,\n        jumpToPreviousMatch: jumpToPreviousMatch,\n        keyword: keyword,\n        matchCase: matchCase,\n        numberOfMatches: found.length,\n        wholeWords: wholeWords,\n        search: search,\n        setKeyword: setKeyword,\n    };\n};\n\nvar Inner = function (_a) {\n    var children = _a.children, doc = _a.doc, store = _a.store;\n    var result = useSearch(doc, store);\n    return children(__assign({}, result));\n};\nvar Search = function (_a) {\n    var children = _a.children, store = _a.store;\n    var currentDoc = useDocument(store).currentDoc;\n    return (currentDoc\n        ? React__default['default'].createElement(Inner, { doc: currentDoc, store: store }, children)\n        : React__default['default'].createElement(React__default['default'].Fragment, null));\n};\n\nvar PORTAL_OFFSET = { left: 0, top: 8 };\nvar SearchPopover = function (_a) {\n    var doc = _a.doc, store = _a.store, onToggle = _a.onToggle;\n    var l10n = React.useContext(core.LocalizationContext);\n    var _b = useSearch(doc, store), clearKeyword = _b.clearKeyword, changeMatchCase = _b.changeMatchCase, changeWholeWords = _b.changeWholeWords, currentMatch = _b.currentMatch, jumpToNextMatch = _b.jumpToNextMatch, jumpToPreviousMatch = _b.jumpToPreviousMatch, keyword = _b.keyword, matchCase = _b.matchCase, numberOfMatches = _b.numberOfMatches, wholeWords = _b.wholeWords, search = _b.search, setKeyword = _b.setKeyword;\n    var onChangeKeyword = function (e) {\n        setKeyword(e.target.value);\n    };\n    var onKeydownSearch = function (e) {\n        if (e.keyCode !== 13 || !keyword) {\n            return;\n        }\n        search();\n    };\n    var onChangeMatchCase = function (e) {\n        changeMatchCase(e.target.checked);\n    };\n    var onChangeWholeWords = function (e) {\n        changeWholeWords(e.target.checked);\n    };\n    var onClose = function () {\n        onToggle();\n        clearKeyword();\n    };\n    return (React__default['default'].createElement(\"div\", { className: 'rpv-search-popover' },\n        React__default['default'].createElement(\"div\", { className: 'rpv-search-popover-input-counter' },\n            React__default['default'].createElement(\"input\", { className: 'rpv-search-popover-input', placeholder: (l10n && l10n.search ? l10n.search.enterToSearch : 'Enter to search'), type: \"text\", value: keyword, onChange: onChangeKeyword, onKeyDown: onKeydownSearch }),\n            React__default['default'].createElement(\"div\", { className: 'rpv-search-popover-counter' },\n                currentMatch,\n                \"/\",\n                numberOfMatches)),\n        React__default['default'].createElement(\"label\", { className: 'rpv-search-popover-label' },\n            React__default['default'].createElement(\"input\", { className: 'rpv-search-popover-label-checkbox', checked: matchCase, type: \"checkbox\", onChange: onChangeMatchCase }),\n            \" \",\n            l10n && l10n.search ? l10n.search.matchCase : 'Match case'),\n        React__default['default'].createElement(\"label\", { className: 'rpv-search-popover-label' },\n            React__default['default'].createElement(\"input\", { className: 'rpv-search-popover-label-checkbox', checked: wholeWords, type: \"checkbox\", onChange: onChangeWholeWords }),\n            \" \",\n            l10n && l10n.search ? l10n.search.wholeWords : 'Whole words'),\n        React__default['default'].createElement(\"div\", { className: 'rpv-search-popover-footer' },\n            React__default['default'].createElement(\"div\", { className: 'rpv-search-popover-footer-item' },\n                React__default['default'].createElement(core.Tooltip, { position: core.Position.BottomCenter, target: React__default['default'].createElement(core.Button, { onClick: jumpToPreviousMatch },\n                        React__default['default'].createElement(PreviousIcon, null)), content: function () { return (l10n && l10n.search ? l10n.search.previousMatch : 'Previous match'); }, offset: PORTAL_OFFSET })),\n            React__default['default'].createElement(\"div\", { className: 'rpv-search-popover-footer-item' },\n                React__default['default'].createElement(core.Tooltip, { position: core.Position.BottomCenter, target: React__default['default'].createElement(core.Button, { onClick: jumpToNextMatch },\n                        React__default['default'].createElement(NextIcon, null)), content: function () { return (l10n && l10n.search ? l10n.search.nextMatch : 'Next match'); }, offset: PORTAL_OFFSET })),\n            React__default['default'].createElement(\"div\", { className: 'rpv-search-popover-footer-button' },\n                React__default['default'].createElement(core.PrimaryButton, { onClick: onClose }, l10n && l10n.search ? l10n.search.close : 'Close')))));\n};\n\nvar ShowSearchPopoverDecorator = function (_a) {\n    var children = _a.children, onClick = _a.onClick;\n    var l10n = React.useContext(core.LocalizationContext);\n    var label = (l10n && l10n.search ? l10n.search.search : 'Search');\n    var icon = React__default['default'].createElement(SearchIcon, null);\n    return children({ icon: icon, label: label, onClick: onClick });\n};\n\nvar TOOLTIP_OFFSET = { left: 0, top: 8 };\nvar ShowSearchPopoverButton = function (_a) {\n    var onClick = _a.onClick;\n    return (React__default['default'].createElement(ShowSearchPopoverDecorator, { onClick: onClick }, function (p) { return (React__default['default'].createElement(core.Tooltip, { position: core.Position.BottomCenter, target: React__default['default'].createElement(core.Button, { onClick: onClick }, p.icon), content: function () { return p.label; }, offset: TOOLTIP_OFFSET })); }));\n};\n\nvar PORTAL_OFFSET$1 = { left: 0, top: 8 };\nvar ShowSearchPopover = function (_a) {\n    var children = _a.children, store = _a.store;\n    var currentDoc = useDocument(store).currentDoc;\n    var defaultChildren = function (props) { return (React__default['default'].createElement(ShowSearchPopoverButton, __assign({}, props))); };\n    var render = children || defaultChildren;\n    return (currentDoc\n        ? (React__default['default'].createElement(core.Popover, { position: core.Position.BottomLeft, target: function (toggle) { return render({\n                onClick: toggle,\n            }); }, content: function (toggle) { return React__default['default'].createElement(SearchPopover, { doc: currentDoc, store: store, onToggle: toggle }); }, offset: PORTAL_OFFSET$1, closeOnClickOutside: false, closeOnEscape: true }))\n        : React__default['default'].createElement(React__default['default'].Fragment, null));\n};\n\nvar calculateOffset = function (children, parent) {\n    var top = children.offsetTop;\n    var left = children.offsetLeft;\n    var p = children.parentElement;\n    while (p && p !== parent) {\n        top += p.offsetTop;\n        left += p.offsetLeft;\n        p = p.parentElement;\n    }\n    return {\n        left: left,\n        top: top,\n    };\n};\n\nvar removeNode = function (ele) {\n    var parent = ele.parentNode;\n    if (parent) {\n        parent.removeChild(ele);\n    }\n};\nvar replaceNode = function (replacementNode, node) {\n    removeNode(replacementNode);\n    var parent = node.parentNode;\n    if (parent) {\n        parent.insertBefore(replacementNode, node);\n    }\n    removeNode(node);\n};\nvar unwrap = function (ele) {\n    var parent = ele.parentNode;\n    if (!parent) {\n        return;\n    }\n    var range = document.createRange();\n    range.selectNodeContents(ele);\n    replaceNode(range.extractContents(), ele);\n    parent.normalize();\n};\n\nvar Tracker = function (_a) {\n    var pageIndex = _a.pageIndex, store = _a.store;\n    var _b = React.useState({\n        matchIndex: -1,\n        pageIndex: -1,\n    }), match = _b[0], setMatch = _b[1];\n    var _c = React.useState([EMPTY_KEYWORD_REGEXP]), keywordRegexp = _c[0], setKeywordRegexp = _c[1];\n    var _d = React.useState({\n        pageIndex: pageIndex,\n        scale: 1,\n        status: core.LayerRenderStatus.PreRender,\n    }), renderStatus = _d[0], setRenderStatus = _d[1];\n    var currentMatchRef = React.useRef(null);\n    var unhighlightAll = function (containerEle) {\n        var highlightNodes = containerEle.querySelectorAll('span.rpv-search-text-highlight');\n        var total = highlightNodes.length;\n        for (var i = 0; i < total; i++) {\n            highlightNodes[i].parentElement.removeChild(highlightNodes[i]);\n        }\n    };\n    var highlight = function (keyword, containerEle, span) {\n        var text = span.textContent;\n        if (!keyword.source.trim() || !text) {\n            return;\n        }\n        var startOffset = text.search(keyword);\n        var firstChild = span.firstChild;\n        if (startOffset === -1 || !firstChild) {\n            return;\n        }\n        var endOffset = startOffset + keyword.source.length;\n        var range = document.createRange();\n        range.setStart(firstChild, startOffset);\n        range.setEnd(firstChild, endOffset);\n        var wrapper = document.createElement('span');\n        range.surroundContents(wrapper);\n        var wrapperRect = wrapper.getBoundingClientRect();\n        var containerRect = containerEle.getBoundingClientRect();\n        var highlightEle = document.createElement('span');\n        containerEle.appendChild(highlightEle);\n        highlightEle.style.left = 100 * (wrapperRect.left - containerRect.left) / containerRect.width + \"%\";\n        highlightEle.style.top = 100 * (wrapperRect.top - containerRect.top) / containerRect.height + \"%\";\n        highlightEle.style.width = 100 * (wrapperRect.width) / containerRect.width + \"%\";\n        highlightEle.style.height = 100 * (wrapperRect.height) / containerRect.height + \"%\";\n        highlightEle.classList.add('rpv-search-text-highlight');\n        unwrap(wrapper);\n    };\n    var highlightAll = function (containerEle) {\n        var spans = [].slice.call(containerEle.querySelectorAll('.rpv-core-text'));\n        keywordRegexp.forEach(function (keyword) {\n            spans.forEach(function (span) {\n                highlight(keyword, containerEle, span);\n            });\n        });\n    };\n    var handleKeywordChanged = function (keyword) {\n        if (keyword && keyword.length > 0) {\n            setKeywordRegexp(keyword);\n        }\n    };\n    var handleMatchChanged = function (currentMatch) {\n        setMatch(currentMatch);\n    };\n    var handleRenderStatusChanged = function (status) {\n        if (!status.has(pageIndex)) {\n            return;\n        }\n        var currentStatus = status.get(pageIndex);\n        if (currentStatus) {\n            setRenderStatus({\n                ele: currentStatus.ele,\n                pageIndex: pageIndex,\n                scale: currentStatus.scale,\n                status: currentStatus.status,\n            });\n        }\n    };\n    var isEmptyKeyword = function () { return keywordRegexp.length === 0 || (keywordRegexp.length === 1 && keywordRegexp[0].source.trim() === ''); };\n    React.useEffect(function () {\n        if (isEmptyKeyword() || !renderStatus.ele || renderStatus.status !== core.LayerRenderStatus.DidRender) {\n            return;\n        }\n        var containerEle = renderStatus.ele;\n        unhighlightAll(containerEle);\n        highlightAll(containerEle);\n        scrollToMatch();\n    }, [keywordRegexp, match, renderStatus.status]);\n    React.useEffect(function () {\n        if (isEmptyKeyword() && renderStatus.ele && renderStatus.status === core.LayerRenderStatus.DidRender) {\n            unhighlightAll(renderStatus.ele);\n        }\n    }, [keywordRegexp, renderStatus.status]);\n    var scrollToMatch = function () {\n        if (match.pageIndex !== pageIndex || !renderStatus.ele || renderStatus.status !== core.LayerRenderStatus.DidRender) {\n            return;\n        }\n        var container = renderStatus.ele;\n        var spans = container.querySelectorAll('.rpv-search-text-highlight');\n        if (match.matchIndex < spans.length) {\n            var span = spans[match.matchIndex];\n            var _a = calculateOffset(span, container), left = _a.left, top_1 = _a.top;\n            var jump = store.get('jumpToDestination');\n            if (jump) {\n                jump(pageIndex, (container.getBoundingClientRect().height - top_1) / renderStatus.scale, left / renderStatus.scale, renderStatus.scale);\n                if (currentMatchRef.current) {\n                    currentMatchRef.current.classList.remove('rpv-search-text-highlight-current');\n                }\n                currentMatchRef.current = span;\n                span.classList.add('rpv-search-text-highlight-current');\n            }\n        }\n    };\n    React.useEffect(function () {\n        store.subscribe('keyword', handleKeywordChanged);\n        store.subscribe('match', handleMatchChanged);\n        store.subscribe('renderStatus', handleRenderStatusChanged);\n        return function () {\n            store.unsubscribe('keyword', handleKeywordChanged);\n            store.unsubscribe('match', handleMatchChanged);\n            store.unsubscribe('renderStatus', handleRenderStatusChanged);\n        };\n    }, []);\n    return React__default['default'].createElement(React__default['default'].Fragment, null);\n};\n\nvar searchPlugin = function (props) {\n    var store = core.createStore({\n        renderStatus: new Map(),\n    });\n    var SearchDecorator = function (props) { return (React__default['default'].createElement(Search, __assign({}, props, { store: store }))); };\n    var ShowSearchPopoverDecorator = function (props) { return (React__default['default'].createElement(ShowSearchPopover, __assign({}, props, { store: store }))); };\n    var ShowSearchPopoverButtonDecorator = function () { return (React__default['default'].createElement(ShowSearchPopoverDecorator, null, function (props) { return React__default['default'].createElement(ShowSearchPopoverButton, __assign({}, props)); })); };\n    var renderViewer = function (props) {\n        var currentSlot = props.slot;\n        if (currentSlot.subSlot) {\n            currentSlot.subSlot.children = (React__default['default'].createElement(React__default['default'].Fragment, null,\n                Array(props.doc.numPages).fill(0).map(function (_, index) { return (React__default['default'].createElement(Tracker, { key: index, pageIndex: index, store: store })); }),\n                currentSlot.subSlot.children));\n        }\n        return currentSlot;\n    };\n    var normalizeKeywordItem = function (keyword) {\n        return typeof keyword === 'string'\n            ? (keyword === '' ? EMPTY_KEYWORD_REGEXP : new RegExp(keyword))\n            : (keyword || EMPTY_KEYWORD_REGEXP);\n    };\n    return {\n        install: function (pluginFunctions) {\n            var keyword = [EMPTY_KEYWORD_REGEXP];\n            if (props) {\n                if (Array.isArray(props.keyword)) {\n                    keyword = (props.keyword).map(function (k) { return normalizeKeywordItem(k); });\n                }\n                else {\n                    keyword = [normalizeKeywordItem(props.keyword)];\n                }\n            }\n            store.update('jumpToDestination', pluginFunctions.jumpToDestination);\n            store.update('jumpToPage', pluginFunctions.jumpToPage);\n            store.update('keyword', keyword);\n        },\n        renderViewer: renderViewer,\n        uninstall: function (props) {\n            var renderStatus = store.get('renderStatus');\n            if (renderStatus) {\n                renderStatus.clear();\n            }\n        },\n        onDocumentLoad: function (props) {\n            store.update('doc', props.doc);\n        },\n        onTextLayerRender: function (props) {\n            var renderStatus = store.get('renderStatus');\n            if (renderStatus) {\n                renderStatus = renderStatus.set(props.pageIndex, props);\n                store.update('renderStatus', renderStatus);\n            }\n        },\n        Search: SearchDecorator,\n        ShowSearchPopover: ShowSearchPopoverDecorator,\n        ShowSearchPopoverButton: ShowSearchPopoverButtonDecorator,\n    };\n};\n\nexports.NextIcon = NextIcon;\nexports.PreviousIcon = PreviousIcon;\nexports.SearchIcon = SearchIcon;\nexports.searchPlugin = searchPlugin;\n"]},"metadata":{},"sourceType":"script"}
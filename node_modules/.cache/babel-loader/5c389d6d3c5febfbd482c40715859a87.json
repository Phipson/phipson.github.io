{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar React = require('react');\n\nvar core = require('@react-pdf-viewer/core');\n\nfunction _interopDefaultLegacy(e) {\n  return e && typeof e === 'object' && 'default' in e ? e : {\n    'default': e\n  };\n}\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar fileName = function (url) {\n  var str = url.split('/').pop();\n  return str ? str.split('#')[0].split('?')[0] : url;\n};\n\nvar downloadFile = function (url, data) {\n  var blobUrl = typeof data === 'string' ? '' : URL.createObjectURL(new Blob([data], {\n    type: ''\n  }));\n  var link = document.createElement('a');\n  link.style.display = 'none';\n  link.href = blobUrl || url;\n  link.setAttribute('download', fileName(url));\n  document.body.appendChild(link);\n  link.click();\n  document.body.removeChild(link);\n\n  if (blobUrl) {\n    URL.revokeObjectURL(blobUrl);\n  }\n};\n\nvar AttachmentList = function (_a) {\n  var files = _a.files;\n  var l10n = React.useContext(core.LocalizationContext);\n\n  var renderItem = function (file) {\n    var onClick = function () {\n      return downloadFile(file.fileName, file.data);\n    };\n\n    return React__default['default'].createElement(\"li\", {\n      className: 'rpv-attachment-item',\n      key: \"attachment-\" + file.fileName,\n      title: l10n && l10n.attachment ? l10n.attachment.clickToDownload : 'Click to download',\n      onClick: onClick\n    }, file.fileName);\n  };\n\n  return files.length === 0 ? React__default['default'].createElement(\"div\", {\n    className: 'rpv-attachment-list-empty'\n  }, l10n && l10n.attachment ? l10n.attachment.noAttachment : 'There is no attachment') : React__default['default'].createElement(\"ul\", {\n    className: 'rpv-attachment-list'\n  }, files.map(renderItem));\n};\n\nvar AttachmentLoader = function (_a) {\n  var doc = _a.doc;\n\n  var _b = React.useState({\n    files: [],\n    isLoaded: false\n  }),\n      attachments = _b[0],\n      setAttachments = _b[1];\n\n  React.useEffect(function () {\n    doc.getAttachments().then(function (response) {\n      var files = response ? Object.keys(response).map(function (file) {\n        return {\n          data: response[file].content,\n          fileName: response[file].filename\n        };\n      }) : [];\n      setAttachments({\n        files: files,\n        isLoaded: true\n      });\n    });\n  }, [doc]);\n  return !attachments.isLoaded ? React__default['default'].createElement(core.Spinner, null) : React__default['default'].createElement(AttachmentList, {\n    files: attachments.files\n  });\n};\n\nvar AttachmentListWithStore = function (_a) {\n  var store = _a.store;\n\n  var _b = React.useState(store.get('doc')),\n      currentDoc = _b[0],\n      setCurrentDoc = _b[1];\n\n  var handleDocumentChanged = function (doc) {\n    setCurrentDoc(doc);\n  };\n\n  React.useEffect(function () {\n    store.subscribe('doc', handleDocumentChanged);\n    return function () {\n      store.unsubscribe('doc', handleDocumentChanged);\n    };\n  }, []);\n  return currentDoc ? React__default['default'].createElement(AttachmentLoader, {\n    doc: currentDoc\n  }) : React__default['default'].createElement(\"div\", {\n    className: 'rpv-attachment-list-loader'\n  }, React__default['default'].createElement(core.Spinner, null));\n};\n\nvar attachmentPlugin = function () {\n  var store = core.createStore({});\n\n  var AttachmentsDecorator = function () {\n    return React__default['default'].createElement(AttachmentListWithStore, {\n      store: store\n    });\n  };\n\n  return {\n    onDocumentLoad: function (props) {\n      store.update('doc', props.doc);\n    },\n    Attachments: AttachmentsDecorator\n  };\n};\n\nexports.attachmentPlugin = attachmentPlugin;","map":{"version":3,"sources":["/Users/phipson/Documents/GitProjects/phipson.github.io/webv5/node_modules/@react-pdf-viewer/attachment/lib/cjs/attachment.js"],"names":["Object","defineProperty","exports","value","React","require","core","_interopDefaultLegacy","e","React__default","fileName","url","str","split","pop","downloadFile","data","blobUrl","URL","createObjectURL","Blob","type","link","document","createElement","style","display","href","setAttribute","body","appendChild","click","removeChild","revokeObjectURL","AttachmentList","_a","files","l10n","useContext","LocalizationContext","renderItem","file","onClick","className","key","title","attachment","clickToDownload","length","noAttachment","map","AttachmentLoader","doc","_b","useState","isLoaded","attachments","setAttachments","useEffect","getAttachments","then","response","keys","content","filename","Spinner","AttachmentListWithStore","store","get","currentDoc","setCurrentDoc","handleDocumentChanged","subscribe","unsubscribe","attachmentPlugin","createStore","AttachmentsDecorator","onDocumentLoad","props","update","Attachments"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar React = require('react');\nvar core = require('@react-pdf-viewer/core');\n\nfunction _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }\n\nvar React__default = /*#__PURE__*/_interopDefaultLegacy(React);\n\nvar fileName = function (url) {\n    var str = url.split('/').pop();\n    return str ? str.split('#')[0].split('?')[0] : url;\n};\n\nvar downloadFile = function (url, data) {\n    var blobUrl = typeof data === 'string'\n        ? ''\n        : URL.createObjectURL(new Blob([data], { type: '' }));\n    var link = document.createElement('a');\n    link.style.display = 'none';\n    link.href = blobUrl || url;\n    link.setAttribute('download', fileName(url));\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    if (blobUrl) {\n        URL.revokeObjectURL(blobUrl);\n    }\n};\n\nvar AttachmentList = function (_a) {\n    var files = _a.files;\n    var l10n = React.useContext(core.LocalizationContext);\n    var renderItem = function (file) {\n        var onClick = function () { return downloadFile(file.fileName, file.data); };\n        return (React__default['default'].createElement(\"li\", { className: 'rpv-attachment-item', key: \"attachment-\" + file.fileName, title: (l10n && l10n.attachment\n                ? l10n.attachment.clickToDownload\n                : 'Click to download'), onClick: onClick }, file.fileName));\n    };\n    return (files.length === 0\n        ? React__default['default'].createElement(\"div\", { className: 'rpv-attachment-list-empty' }, l10n && l10n.attachment\n            ? l10n.attachment.noAttachment\n            : 'There is no attachment')\n        : (React__default['default'].createElement(\"ul\", { className: 'rpv-attachment-list' }, files.map(renderItem))));\n};\n\nvar AttachmentLoader = function (_a) {\n    var doc = _a.doc;\n    var _b = React.useState({\n        files: [],\n        isLoaded: false,\n    }), attachments = _b[0], setAttachments = _b[1];\n    React.useEffect(function () {\n        doc.getAttachments().then(function (response) {\n            var files = response\n                ? Object.keys(response).map(function (file) {\n                    return {\n                        data: response[file].content,\n                        fileName: response[file].filename,\n                    };\n                })\n                : [];\n            setAttachments({\n                files: files,\n                isLoaded: true,\n            });\n        });\n    }, [doc]);\n    return (!attachments.isLoaded\n        ? React__default['default'].createElement(core.Spinner, null)\n        : React__default['default'].createElement(AttachmentList, { files: attachments.files }));\n};\n\nvar AttachmentListWithStore = function (_a) {\n    var store = _a.store;\n    var _b = React.useState(store.get('doc')), currentDoc = _b[0], setCurrentDoc = _b[1];\n    var handleDocumentChanged = function (doc) {\n        setCurrentDoc(doc);\n    };\n    React.useEffect(function () {\n        store.subscribe('doc', handleDocumentChanged);\n        return function () {\n            store.unsubscribe('doc', handleDocumentChanged);\n        };\n    }, []);\n    return (currentDoc\n        ? React__default['default'].createElement(AttachmentLoader, { doc: currentDoc })\n        : React__default['default'].createElement(\"div\", { className: 'rpv-attachment-list-loader' },\n            React__default['default'].createElement(core.Spinner, null)));\n};\n\nvar attachmentPlugin = function () {\n    var store = core.createStore({});\n    var AttachmentsDecorator = function () { return (React__default['default'].createElement(AttachmentListWithStore, { store: store })); };\n    return {\n        onDocumentLoad: function (props) {\n            store.update('doc', props.doc);\n        },\n        Attachments: AttachmentsDecorator,\n    };\n};\n\nexports.attachmentPlugin = attachmentPlugin;\n"]},"metadata":{},"sourceType":"script"}